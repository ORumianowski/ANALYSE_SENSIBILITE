theme_minimal() +
ggtitle("Initial Model")
ggplot() +
geom_line(data = effectif, aes(x = temps, y = C1/N, color = "First Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C2/N, color = "Second Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C3/N, color = "Third Age Class"), linewidth = 1) +
scale_y_continuous(expand = c(0, 0)) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot() +
geom_line(data = effectif, aes(x = temps, y = C1/N, color = "First Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C2/N, color = "Second Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C3/N, color = "Third Age Class"), linewidth = 1) +
scale_y_continuous(limits = c(0, 1)) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot() +
geom_line(data = effectif, aes(x = temps, y = C1/N, color = "First Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C2/N, color = "Second Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C3/N, color = "Third Age Class"), linewidth = 1) +
scale_y_continuous(limits = c(0, 0.6)) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot() +
geom_line(data = effectif, aes(x = temps, y = C1/N, color = "First Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C2/N, color = "Second Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C3/N, color = "Third Age Class"), linewidth = 1) +
scale_y_continuous(limits = c(0, 0.55)) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(sensitivity)
source(file = "functionModProjet2023.r")
ValNominale = c(100, 0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_initial = matrix(ValNominale, nrow=1, ncol=15)
res = modAppli1(scenario_initial)
effectif = tibble(
temps = 1:(2*365),
S = res[[2]][4,1,],
L = res[[2]][4,2,],
I = res[[2]][4,3,],
R = res[[2]][4,4,],
N = S + L + I + R,
C1 = res[[2]][1,1,] + res[[2]][1,2,] + res[[2]][1,3,] + res[[2]][1,4,],
C2 = res[[2]][2,1,] + res[[2]][2,2,] + res[[2]][2,3,] + res[[2]][2,4,],
C3 = res[[2]][3,1,] + res[[2]][3,2,] + res[[2]][3,3,] + res[[2]][3,4,]
)
ggplot() +
geom_line(data = effectif, aes(x = temps, y = S, color = "1- Susceptible"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = L, color = "2- Latent"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = I, color = "3- Infectious"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = R, color = "4- Recovered"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = N, color = "Population Size"), linewidth = 1) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot() +
geom_line(data = effectif, aes(x = temps, y = C1/N, color = "First Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C2/N, color = "Second Age Class"), linewidth = 1) +
geom_line(data = effectif, aes(x = temps, y = C3/N, color = "Third Age Class"), linewidth = 1) +
scale_y_continuous(limits = c(0, 0.55)) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
effectif
rbind(effectif$C1,
effectif$C2,
effectif$C3)
effectif$C1
?rep()
re("e", 5)
rep("e", 5)
effectif
effectif2 <- rbind(effectif$C1,
effectif$C2,
effectif$C3)
effectif2
effectif2 <- tibble(effectif = rbind(effectif$C1,
effectif$C2,
effectif$C3))
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggpubr)
library(sensitivity)
source(file = "functionModProjet2023.r")
ValNominale = c(100, 0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_initial = matrix(ValNominale, nrow=1, ncol=15)
res = modAppli1(scenario_initial)
effectif_data = tibble(
temps = 1:(2*365),
S = res[[2]][4,1,],
L = res[[2]][4,2,],
I = res[[2]][4,3,],
R = res[[2]][4,4,],
N = S + L + I + R,
C1 = res[[2]][1,1,] + res[[2]][1,2,] + res[[2]][1,3,] + res[[2]][1,4,],
C2 = res[[2]][2,1,] + res[[2]][2,2,] + res[[2]][2,3,] + res[[2]][2,4,],
C3 = res[[2]][3,1,] + res[[2]][3,2,] + res[[2]][3,3,] + res[[2]][3,4,]
)
ggplot() +
geom_line(data = effectif_data, aes(x = temps, y = S, color = "1- Susceptible"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = L, color = "2- Latent"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = I, color = "3- Infectious"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = R, color = "4- Recovered"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = N, color = "Population Size"), linewidth = 1) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot() +
geom_line(data = effectif_data, aes(x = temps, y = C1/N, color = "First Age Class"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = C2/N, color = "Second Age Class"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = C3/N, color = "Third Age Class"), linewidth = 1) +
scale_y_continuous(limits = c(0, 0.55)) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
effectif2 <- tibble(effectif =
rbind(effectif_data$C1,
effectif_data$C2,
effectif_data$C3))  %>%
mutate(age_class = rep(c("C1", "C2", "C3"), each = nrows(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
effectif_data
tibble(effectif =
rbind(effectif_data$C1,
effectif_data$C2,
effectif_data$C3))
effectif_data
effectif_data$C1
tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3))
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3))  %>%
mutate(age_class = rep(c("C1", "C2", "C3"), each = nrows(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3))  %>%
mutate(age_class = rep(c("C1", "C2", "C3"), each = nrows(effectif_data) ))
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3))  %>%
mutate(age_class = rep(c("C1", "C2", "C3"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
effectif_data2 <- tibble(effectif =
(effectif_data$C1,
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3,
temps = rep(effectif_data$temps, times = 3)))  %>%
mutate(age_class = rep(c("C1", "C2", "C3"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3,
temps = rep(effectif_data$temps, times = 3)))
effectif_data2
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))
effectif_data2
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))  %>%
mutate(age_class = rep(c("C1", "C2", "C3"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
# Plot
ggplot(effectif, aes(x=time, y=percentage, fill=group)) +
geom_area(alpha=0.6 , size=1, colour="black")
effectif_data2
# Plot
ggplot(effectif, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.6 , size=1, colour="black")
# Plot
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.6 , size=1, colour="black")
ggplot() +
geom_line(data = effectif_data, aes(x = temps, y = C1/N, color = "First Age Class"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = C2/N, color = "Second Age Class"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = C3/N, color = "Third Age Class"), linewidth = 1) +
scale_y_continuous(limits = c(0, 0.55)) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))  %>%
mutate(age_class = rep(c("C1", "C2", "C3"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))  %>%
mutate(age_class = rep(c("C1", "C2", "C3"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.6 , size=1, colour="black")
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.6 , size=1, colour="black")+
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.6 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.4 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.3 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.4 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of age structure in the Initial Model")
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.4 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of age structure - Initial Model")
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))  %>%
mutate(age_class = rep(c("First Age Class", "Second Age Class", "Third Age Class"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.4 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of age structure - Initial Model")
ggplot() +
geom_line(data = effectif_data, aes(x = temps, y = S, color = "1- Susceptible"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = L, color = "2- Latent"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = I, color = "3- Infectious"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = R, color = "4- Recovered"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = N, color = "Population Size"), linewidth = 1) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))  %>%
mutate(age_class = rep(c("First Age Class", "Second Age Class", "Third Age Class"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.4 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of age structure - Initial Model")
ggplot() +
geom_line(data = effectif_data, aes(x = temps, y = S, color = "1- Susceptible"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = L, color = "2- Latent"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = I, color = "3- Infectious"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = R, color = "4- Recovered"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = N, color = "Population Size"), linewidth = 1) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Initial Model")
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))  %>%
mutate(age_class = rep(c("First Age Class", "Second Age Class", "Third Age Class"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.4 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of age structure - Initial Model")
p1 = ggplot() +
geom_line(data = effectif_data, aes(x = temps, y = S, color = "1- Susceptible"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = L, color = "2- Latent"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = I, color = "3- Infectious"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = R, color = "4- Recovered"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = N, color = "Population Size"), linewidth = 1) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of Epidemic stages - Initial Model")
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))  %>%
mutate(age_class = rep(c("First Age Class", "Second Age Class", "Third Age Class"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
p2 = ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.4 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of age structure - Initial Model")
initial_figures = ggarrange(p1, p2, ncol = 2, labels = c("1", "2"), vjust = -0.1)
initial_figures
p1 = ggplot() +
geom_line(data = effectif_data, aes(x = temps, y = S, color = "1- Susceptible"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = L, color = "2- Latent"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = I, color = "3- Infectious"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = R, color = "4- Recovered"), linewidth = 1) +
geom_line(data = effectif_data, aes(x = temps, y = N, color = "Population Size"), linewidth = 1) +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of Epidemic stages - Initial Model")
effectif_data2 <- tibble(effectif =
c(effectif_data$C1,
effectif_data$C2,
effectif_data$C3),
temps = rep(effectif_data$temps, times = 3))  %>%
mutate(age_class = rep(c("First Age Class", "Second Age Class", "Third Age Class"), each = nrow(effectif_data) )) %>%
group_by(temps, age_class) %>%
summarise(n = sum(effectif)) %>%
mutate(percentage = n / sum(n))
p2 = ggplot(effectif_data2, aes(x=temps, y=percentage, fill=age_class)) +
geom_area(alpha=0.4 , size=1, colour="black")+
labs(fill = "Age class") +
labs(x = "Time", y = "Effectif") +
theme_minimal() +
ggtitle("Evolution of age structure - Initial Model")
p1
p2
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
lowerValues = ValNominale*.75
upperValues = ValNominale*1.25
Fast <- fast99(model = modAppli,
factors = par_name,
n = 10,
q = "qunif", q.arg = list(min = -pi, max = pi)
)
Fast
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
lowerValues = ValNominale*.75
upperValues = ValNominale*1.25
Fast <- fast99(model = modAppli,
factors = par_name,
n = 100,
q = "qunif", q.arg = list(min = -pi, max = pi)
)
Fast
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
Fast <- fast99(model = modAppli,
factors = par_name,
n = 100,
q = "qunif", q.arg = list(min = 0.1, max = 5)
)
Fast
Fast <- fast99(model = modAppli,
factors = par_name,
n = 10,
q = "qunif", q.arg = list(min = 0.1, max = 50)
)
Fast
Fast <- fast99(model = modAppli,
factors = par_name,
n = 10,
q = "qunif", q.arg = list(min = 0, max = 1)
)
Fast
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
Fast <- fast99(model = modAppli,
factors = par_name,
n = 10,
q = "qunif", q.arg = list(min = 0, max = 1)
)
Fast
plot(Fast)
Fast
plot(Fast)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
q.arg_ = list(
list(min = 10, max = 500),#K
list(min = 0.1, max = 9.9),#sr
list(min = 0.00001, max = 0.1),#m1
list(min = 0.00001, max = 0.1),#m2
list(min = 0.00001, max = 0.1),#m3
list(min = 0.00001, max = 0.1),#f2
list(min = 0.00001, max = 0.1),#f3
list(min = 1, max = 10),#portee
list(min = 0.00001, max = 0.1),#t1
list(min = 0.00001, max = 0.1),#t2
list(min = 0.05, max = 0.6),#trans
list(min = 0.05, max = 0.6),#lat
list(min = 0.00001, max = 0.1),#rec
list(min = 0.00001, max = 0.1),#loss
list(min = 0.00001, max = 0.1),#madd
)
Fast <- fast99(model = modAppli,
factors = par_name,
n = 10,
q = "qunif", q.arg = q.arg_
)
q.arg_ = list(
list(min = 10, max = 500),#K
list(min = 0.1, max = 9.9),#sr
list(min = 0.00001, max = 0.1),#m1
list(min = 0.00001, max = 0.1),#m2
list(min = 0.00001, max = 0.1),#m3
list(min = 0.00001, max = 0.1),#f2
list(min = 0.00001, max = 0.1),#f3
list(min = 1, max = 10),#portee
list(min = 0.00001, max = 0.1),#t1
list(min = 0.00001, max = 0.1),#t2
list(min = 0.05, max = 0.6),#trans
list(min = 0.05, max = 0.6),#lat
list(min = 0.00001, max = 0.1),#rec
list(min = 0.00001, max = 0.1),#loss
list(min = 0.00001, max = 0.1),#madd
)
q.arg_ = list(
list(min = 10, max = 500),#K
list(min = 0.1, max = 9.9),#sr
list(min = 0.00001, max = 0.1),#m1
list(min = 0.00001, max = 0.1),#m2
list(min = 0.00001, max = 0.1),#m3
list(min = 0.00001, max = 0.1),#f2
list(min = 0.00001, max = 0.1),#f3
list(min = 1, max = 10),#portee
list(min = 0.00001, max = 0.1),#t1
list(min = 0.00001, max = 0.1),#t2
list(min = 0.05, max = 0.6),#trans
list(min = 0.05, max = 0.6),#lat
list(min = 0.00001, max = 0.1),#rec
list(min = 0.00001, max = 0.1),#loss
list(min = 0.00001, max = 0.1)#madd
)
Fast <- fast99(model = modAppli,
factors = par_name,
n = 10,
q = "qunif", q.arg = q.arg_
)
Fast
Fast <- fast99(model = modAppli,
factors = par_name,
n = 20,
q = "qnorm", q.arg = q.arg_
)
Fast <- fast99(model = modAppli,
factors = par_name,
n = 20,
q = "qnorm", q.arg = q.arg_
)
Fast <- fast99(model = modAppli,
factors = par_name,
n = 20,
q = "qunif", q.arg = q.arg_
)
Fast
