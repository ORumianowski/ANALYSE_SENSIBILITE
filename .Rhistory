infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])
res_plot2 = tibble( index = c("S1", "S2", "S3", "S4",
"S1", "S2","S3","S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value, fill=group))+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="Paired")+
theme_minimal()
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])
res_plot2 = tibble( index = c("S1", "S2", "S3", "S4",
"S1", "S2", "S3","S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value, fill=group),stat="identity")+
theme(axis.text.x = element_text(angle = 90))
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])
res_plot2 = tibble( index = c("S1", "S2", "S3", "S4",
"S1", "S2", "S3","S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value, fill=group))+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="Paired")+
theme_minimal()
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])
res_plot2 = tibble( index = c("S1", "S2", "S3", "S4",
"S1", "S2", "S3","S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value),stat="identity")+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="Paired")+
theme_minimal()
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
res_plot2
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])
res_plot2 = tibble( index = c("S1", "S2", "S3", "S4",
"S1", "S2", "S3","S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value),stat="identity")+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer()+
theme_minimal()
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])
res_plot2 = tibble( index = c("A-S1","A-S2", "A-S3", "A-S4",
"DS-S1", "DS-S2", "DS-S3","DS-S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value),stat="identity")+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer()+
theme_minimal()
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])
res_plot2 = tibble( index = c("A-S1","A-S2", "A-S3", "A-S4",
"DS-S1", "DS-S2", "DS-S3","DS-S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value, fill = group),stat="identity")+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer("paired")+
theme_minimal()
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])
res_plot2 = tibble( index = c("A-S1","A-S2", "A-S3", "A-S4",
"DS-S1", "DS-S2", "DS-S3","DS-S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value, fill = group),stat="identity")+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="Paired")+
theme_minimal()
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])+
theme(legend.title = element_blank())
res_plot2 = tibble( index = c("A-S1","A-S2", "A-S3", "A-S4",
"DS-S1", "DS-S2", "DS-S3","DS-S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value, fill = group),stat="identity")+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="Paired")+
theme_minimal()+
theme(legend.title = element_blank())
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
ValNominale = c(100,
0.5, 0.0014, 0.00029, 0.0019,
0.0019, 0.0082, 5, 1/365, 1/365,
0.3, 1/5, 1/20, 1/100, 0.001)
scenario_OAT =  matrix(rep(ValNominale, each = 11), nrow = 11, ncol = 15)
graph_oat = function(i){
scenario_OAT_i = scenario_OAT
inf = ValNominale[i] * 0.75
sup = ValNominale[i] * 1.25
scenario_OAT_i[, i] = pracma::linspace(inf,sup, n = 11)
sortie = modAppli(scenario_OAT_i)
res_plot = tibble(paramettre_i = scenario_OAT_i[, i],
prop_inf = sortie[,1]/sortie[1,1],
infec_end = sortie[,2]/sortie[1,2],
nb_max_infec = sortie[,3]/sortie[1,3] ,
nb_infec_year1 = sortie[,4]/sortie[1,4])
p1 = ggplot() +
geom_line(data = res_plot, aes(x = paramettre_i, y = prop_inf, color = "S1"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = infec_end, color = "S2"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_max_infec,  color = "S3"), size = 1) +
geom_line(data = res_plot, aes(x = paramettre_i, y = nb_infec_year1,  color = "S4"), size = 1) +
scale_x_continuous(trans='log10') +
labs(x = "Parameter value", y = "Relative variation") +
theme_minimal() +
ggtitle(par_name[i])+
theme(legend.title = element_blank())
res_plot2 = tibble( index = c("A-S1","A-S2", "A-S3", "A-S4",
"DS-S1", "DS-S2", "DS-S3","DS-S4"),
group=rep(c("Amplitude", "Standard Deviation"), each=4),
value = c(max(res_plot$prop_inf) - min(res_plot$prop_inf),
max(res_plot$infec_end)-min(res_plot$infec_end),
max(res_plot$nb_max_infec)-min(res_plot$nb_max_infec),
max(res_plot$nb_infec_year1)-min(res_plot$nb_infec_year1),
sd(res_plot$prop_inf),
sd(res_plot$infec_end),
sd(res_plot$nb_max_infec),
sd(res_plot$nb_infec_year1)))
p2 = ggplot()+
geom_bar(data=res_plot2, aes(x=index, y=value, fill = group),stat="identity")+
theme(axis.text.x = element_text(angle = 90))+
scale_fill_brewer(palette="Paired")+
theme_minimal()+
theme(legend.title = element_blank())+
theme(axis.text.x = element_text(angle = 90))
p3 = ggarrange(p1, p2,
ncol = 2, nrow = 1)
return(p3)
}
graph_oat(i = 2)
ggarrange(graph_oat(i = 1),
graph_oat(i = 2),
ncol = 1, nrow = 2)
ggarrange(graph_oat(i = 3),
graph_oat(i = 4),
ncol = 1, nrow = 2)
ggarrange(graph_oat(i = 5),
graph_oat(i = 6),
ncol = 1, nrow = 2)
ggarrange(graph_oat(i = 7),
graph_oat(i = 8),
ncol = 1, nrow = 2)
ggarrange(graph_oat(i = 9),
graph_oat(i = 10),
ncol = 1, nrow = 2)
ggarrange(graph_oat(i = 11),
graph_oat(i = 12),
ncol = 1, nrow = 2)
ggarrange(graph_oat(i = 13),
graph_oat(i = 14),
ncol = 1, nrow = 2)
ggarrange(graph_oat(i = 15),
ncol = 1, nrow = 2)
q.arg4 = list(min = ValNominale*.75, max = ValNominale*1.25)
Fast <- fast99(model = modAppli,
factors = par_name,
n = 100,
q = rep("qunif", 15),
q.arg = q.arg4
)
Fast$X
plot(Fast)
Fast
Fast$X
plot(Fast)
par_name = c("K", "sr", "m1", "m2", "m3", "f2", "f3", "portee", "t1", "t2", "trans", "lat", "rec", "loss", "madd")
q.arg4 = list(min = ValNominale*.75, max = ValNominale*1.25)
Fast <- fast99(model = modAppli,
factors = par_name,
n = 100,
q = rep("qunif", 15),
q.arg = q.arg4
)
q.arg4 = list(min = ValNominale*.75, max = ValNominale*1.25)
Fast <- fast99(model = NULL,
factors = par_name,
n = 100,
q = rep("qunif", 15),
q.arg = q.arg4
)
Fast$X
ValNominale*.75
